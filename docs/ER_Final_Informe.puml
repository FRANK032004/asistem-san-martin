@startuml Instituto_San_Martin_ER_Final
!theme cerulean-outline
title **MODELO ENTIDAD-RELACIÃ“N**\n**INSTITUTO SAN MARTÃN - SISTEMA DE GESTIÃ“N ACADÃ‰MICA**\n//DiseÃ±o de Base de Datos - Informe AcadÃ©mico 2024//

' =============== CONFIGURACIÃ“N PROFESIONAL PARA INFORME ===============
skinparam {
  backgroundColor #FEFEFE
  shadowing false
  linetype ortho
  roundcorner 4
  defaultFontSize 11
  nodesep 55
  ranksep 85
  minClassWidth 170
  packageBorderThickness 2
}

' Colores diferenciados por nivel funcional
skinparam entity<<core>> {
  BackgroundColor #E3F2FD
  BorderColor #1976D2
  BorderThickness 2
}

skinparam entity<<operation>> {
  BackgroundColor #F3E5F5
  BorderColor #7B1FA2
  BorderThickness 2
}

skinparam entity<<management>> {
  BackgroundColor #E8F5E8
  BorderColor #388E3C
  BorderThickness 2
}

skinparam entity {
  FontSize 10
  FontStyle bold
}

' =============== NIVEL 1: ENTIDADES CORE DEL SISTEMA ===============

entity "Usuario" as usuario <<core>> {
  ğŸ”‘ **id** : UUID
  --
  â€¢ dni : VARCHAR(20) âšª
  â€¢ nombres : VARCHAR(100)
  â€¢ apellidos : VARCHAR(100)
  â€¢ email : VARCHAR(150) âšª
  â€¢ password_hash : VARCHAR(255)
  ğŸ”— rol_id : INT
  â€¢ activo : BOOLEAN
  â€¢ ultimo_acceso : TIMESTAMP
  â€¢ created_at : TIMESTAMP
}

entity "Role" as role <<core>> {
  ğŸ”‘ **id** : INT
  --
  â€¢ nombre : VARCHAR(50) âšª
  â€¢ descripcion : TEXT
  â€¢ permisos : VARCHAR[]
  â€¢ created_at : TIMESTAMP
  â€¢ updated_at : TIMESTAMP
}

entity "Area" as area <<core>> {
  ğŸ”‘ **id** : INT
  --
  â€¢ nombre : VARCHAR(100)
  â€¢ codigo : VARCHAR(10) âšª
  â€¢ descripcion : TEXT
  ğŸ”— coordinador_id : UUID
  â€¢ activa : BOOLEAN
  â€¢ color_hex : VARCHAR(7)
}

entity "Docente" as docente <<core>> {
  ğŸ”‘ **id** : UUID
  --
  ğŸ”— usuario_id : UUID
  ğŸ”— area_id : INT
  â€¢ codigo_docente : VARCHAR(20) âšª
  â€¢ fecha_ingreso : DATE
  â€¢ fecha_nacimiento : DATE
  â€¢ sueldo : DECIMAL(10,2)
  â€¢ estado : VARCHAR(20)
  â€¢ observaciones : TEXT
}

' =============== NIVEL 2: ENTIDADES DE OPERACIÃ“N ===============

entity "ContratoDocente" as contrato <<operation>> {
  ğŸ”‘ **id** : INT
  --
  ğŸ”— docente_id : UUID
  â€¢ tipo_contrato : VARCHAR(20)
  â€¢ tarifa_por_hora : DECIMAL(8,2)
  â€¢ sueldo_base : DECIMAL(10,2)
  â€¢ fecha_inicio : DATE
  â€¢ fecha_fin : DATE
  â€¢ activo : BOOLEAN
  â€¢ created_at : TIMESTAMP
}

entity "Asistencia" as asistencia <<operation>> {
  ğŸ”‘ **id** : UUID
  --
  ğŸ”— docente_id : UUID
  â€¢ fecha : DATE âšª
  â€¢ hora_entrada : TIMESTAMP
  â€¢ hora_salida : TIMESTAMP
  â€¢ estado : VARCHAR(20)
  â€¢ tardanza_minutos : INT
  â€¢ horas_trabajadas : DECIMAL(4,2)
  â€¢ gps_valido_entrada : BOOLEAN
  â€¢ observaciones : TEXT
}

entity "HorarioBase" as horario <<operation>> {
  ğŸ”‘ **id** : INT
  --
  ğŸ”— docente_id : UUID
  ğŸ”— area_id : INT
  â€¢ dia_semana : INT
  â€¢ hora_inicio : TIME
  â€¢ hora_fin : TIME
  â€¢ tipo_clase : VARCHAR(50)
  â€¢ activo : BOOLEAN
  â€¢ created_at : TIMESTAMP
}

entity "UbicacionPermitida" as ubicacion <<operation>> {
  ğŸ”‘ **id** : INT
  --
  â€¢ nombre : VARCHAR(100)
  â€¢ latitud : DECIMAL(10,8)
  â€¢ longitud : DECIMAL(11,8)
  â€¢ radio_metros : INT
  â€¢ tipo_ubicacion : VARCHAR(30)
  â€¢ activa : BOOLEAN
}

' =============== NIVEL 3: ENTIDADES DE GESTIÃ“N ===============

entity "PlanillaHoras" as planilla <<management>> {
  ğŸ”‘ **id** : UUID
  --
  ğŸ”— docente_id : UUID
  ğŸ”— contrato_id : INT
  â€¢ anio : INT
  â€¢ mes : INT
  â€¢ horas_trabajadas : DECIMAL(6,2)
  â€¢ horas_extras : DECIMAL(6,2)
  â€¢ monto_total : DECIMAL(10,2)
  â€¢ estado : VARCHAR(20)
  â€¢ fecha_pago : DATE
}

entity "EvaluacionDocente" as evaluacion <<management>> {
  ğŸ”‘ **id** : UUID
  --
  ğŸ”— docente_id : UUID
  ğŸ”— evaluador_id : UUID
  â€¢ periodo : VARCHAR(20)
  â€¢ porcentaje_asistencia : DECIMAL(5,2)
  â€¢ porcentaje_puntualidad : DECIMAL(5,2)
  â€¢ calificacion_general : DECIMAL(3,1)
  â€¢ fecha_evaluacion : DATE
  â€¢ observaciones : TEXT
}

entity "Justificacion" as justificacion <<management>> {
  ğŸ”‘ **id** : UUID
  --
  ğŸ”— docente_id : UUID
  ğŸ”— asistencia_id : UUID
  â€¢ tipo : VARCHAR(50)
  â€¢ motivo : TEXT
  â€¢ estado : VARCHAR(20)
  ğŸ”— aprobado_por : UUID
  â€¢ afecta_pago : BOOLEAN
  â€¢ created_at : TIMESTAMP
}

entity "Notificacion" as notificacion <<management>> {
  ğŸ”‘ **id** : UUID
  --
  ğŸ”— usuario_id : UUID
  â€¢ titulo : VARCHAR(200)
  â€¢ mensaje : TEXT
  â€¢ tipo : VARCHAR(50)
  â€¢ leido : BOOLEAN
  â€¢ fecha_envio : TIMESTAMP
  â€¢ activa : BOOLEAN
}

' =============== RELACIONES PRINCIPALES ===============

' Relaciones Core
role ||--o{ usuario : "asigna"
usuario ||--|| docente : "perfil"
area ||--o{ docente : "pertenece"
usuario ||--o{ area : "coordina"

' Relaciones Operacionales
docente ||--o{ contrato : "firma"
docente ||--o{ asistencia : "registra"
docente ||--o{ horario : "asignado"
ubicacion ||--o{ asistencia : "vÃ¡lida en"

' Relaciones de GestiÃ³n
contrato ||--o{ planilla : "genera"
docente ||--o{ evaluacion : "evaluado"
asistencia ||--o{ justificacion : "justifica"
usuario ||--o{ notificacion : "recibe"

' Relaciones Transversales
usuario ||--o{ evaluacion : "evalÃºa"
usuario ||--o{ justificacion : "aprueba"

' =============== ORGANIZACIÃ“N ESPACIAL ===============

' AlineaciÃ³n horizontal por niveles
usuario -[hidden]right-> role
role -[hidden]right-> area
area -[hidden]right-> docente

contrato -[hidden]right-> asistencia
asistencia -[hidden]right-> horario
horario -[hidden]right-> ubicacion

planilla -[hidden]right-> evaluacion
evaluacion -[hidden]right-> justificacion
justificacion -[hidden]right-> notificacion

' SeparaciÃ³n vertical por niveles
usuario -[hidden]down-> contrato
role -[hidden]down-> asistencia
area -[hidden]down-> horario
docente -[hidden]down-> ubicacion

contrato -[hidden]down-> planilla
asistencia -[hidden]down-> evaluacion
horario -[hidden]down-> justificacion
ubicacion -[hidden]down-> notificacion

' =============== DOCUMENTACIÃ“N ACADÃ‰MICA ===============

note top of usuario : **ğŸ” NÃšCLEO DE AUTENTICACIÃ“N**\nControl de acceso y seguridad\nBase para trazabilidad del sistema

note top of docente : **ğŸ‘¨â€ğŸ« ENTIDAD PRINCIPAL**\nCore del sistema acadÃ©mico\nCentraliza informaciÃ³n docente

note bottom of contrato : **ğŸ“‹ GESTIÃ“N CONTRACTUAL**\nModalidades: completo, por horas, temporal\nBase para cÃ¡lculos de nÃ³mina

note bottom of planilla : **ğŸ’° AUTOMATIZACIÃ“N FINANCIERA**\nCÃ¡lculo automÃ¡tico de pagos\nIntegraciÃ³n asistencias-evaluaciones

note right of evaluacion : **ğŸ“Š SISTEMA DE EVALUACIÃ“N**\nMÃ©tricas de rendimiento acadÃ©mico\nSoporte a decisiones institucionales

note left of asistencia : **ğŸ“ CONTROL GEOLOCALIZADO**\nValidaciÃ³n GPS y temporal\nTrazabilidad completa de horarios

' =============== LEYENDA ACADÃ‰MICA PROFESIONAL ===============

legend bottom center
|= **SIMBOLOGÃA TÃ‰CNICA** |= **NIVELES ARQUITECTÃ“NICOS** |
| ğŸ”‘ | Clave Primaria (Primary Key) | **Azul:** Entidades Core (Usuarios, Roles, Ãreas) |
| ğŸ”— | Clave ForÃ¡nea (Foreign Key) | **Violeta:** Entidades Operacionales (Contratos, Asistencias) |
| âšª | Campo Ãšnico (Unique Constraint) | **Verde:** Entidades de GestiÃ³n (NÃ³mina, Evaluaciones) |
| â€¢ | Campo Obligatorio (NOT NULL) | |

|= **CARACTERÃSTICAS DEL SISTEMA** |= **INFORMACIÃ“N TÃ‰CNICA** |
| **Entidades Principales:** 12 | **InstituciÃ³n:** San MartÃ­n |
| **Relaciones:** 15 conexiones | **VersiÃ³n:** 2.0 AcadÃ©mica |
| **Usuarios Concurrentes:** 50+ | **Fecha:** Octubre 2024 |
| **Arquitectura:** 3 niveles funcionales | **Stack:** PostgreSQL + Prisma + Next.js |
end legend

@enduml